{"ast":null,"code":"import{format,startOfWeek,endOfWeek,isWithinInterval}from'date-fns';const STORAGE_KEYS={DAILY_DATA:'delivery-tracker-daily-data',STORES:'delivery-tracker-stores',SETTINGS:'delivery-tracker-settings'};export class StorageManager{static getDailyData(){try{const data=localStorage.getItem(STORAGE_KEYS.DAILY_DATA);return data?JSON.parse(data):[];}catch(error){console.error('Error loading daily data:',error);return[];}}static saveDailyData(data){try{localStorage.setItem(STORAGE_KEYS.DAILY_DATA,JSON.stringify(data));}catch(error){console.error('Error saving daily data:',error);}}static getStores(){try{const data=localStorage.getItem(STORAGE_KEYS.STORES);return data?JSON.parse(data):[];}catch(error){console.error('Error loading stores:',error);return[];}}static saveStores(stores){try{localStorage.setItem(STORAGE_KEYS.STORES,JSON.stringify(stores));}catch(error){console.error('Error saving stores:',error);}}static getTodayData(){const allData=this.getDailyData();const today=format(new Date(),'yyyy-MM-dd');return allData.find(data=>data.date===today)||null;}static getWeekData(){const allData=this.getDailyData();const now=new Date();const weekStart=startOfWeek(now,{weekStartsOn:1});const weekEnd=endOfWeek(now,{weekStartsOn:1});return allData.filter(data=>{const dataDate=new Date(data.date);return isWithinInterval(dataDate,{start:weekStart,end:weekEnd});});}static createEmptyDailyData(date){return{date:format(date,'yyyy-MM-dd'),deliveries:[],summary:{totalStores:0,totalDeliveries:0,totalDelivered:0,totalPending:0,totalBills:0,totalRevenue:0,totalPaid:0,totalOutstanding:0}};}static updateDailyData(updatedData){const allData=this.getDailyData();const existingIndex=allData.findIndex(data=>data.date===updatedData.date);if(existingIndex>=0){allData[existingIndex]=updatedData;}else{allData.push(updatedData);}// Sort by date descending\nallData.sort((a,b)=>new Date(b.date).getTime()-new Date(a.date).getTime());this.saveDailyData(allData);}static calculateSummary(deliveries){return deliveries.reduce((summary,delivery)=>({totalStores:summary.totalStores+1,totalDeliveries:summary.totalDeliveries+delivery.totalDeliveries,totalDelivered:summary.totalDelivered+delivery.delivered,totalPending:summary.totalPending+delivery.pending,totalBills:summary.totalBills+delivery.bills,totalRevenue:summary.totalRevenue+delivery.paymentStatus.total,totalPaid:summary.totalPaid+delivery.paymentStatus.paid,totalOutstanding:summary.totalOutstanding+delivery.paymentStatus.pending+delivery.paymentStatus.overdue}),{totalStores:0,totalDeliveries:0,totalDelivered:0,totalPending:0,totalBills:0,totalRevenue:0,totalPaid:0,totalOutstanding:0});}}","map":{"version":3,"names":["format","startOfWeek","endOfWeek","isWithinInterval","STORAGE_KEYS","DAILY_DATA","STORES","SETTINGS","StorageManager","getDailyData","data","localStorage","getItem","JSON","parse","error","console","saveDailyData","setItem","stringify","getStores","saveStores","stores","getTodayData","allData","today","Date","find","date","getWeekData","now","weekStart","weekStartsOn","weekEnd","filter","dataDate","start","end","createEmptyDailyData","deliveries","summary","totalStores","totalDeliveries","totalDelivered","totalPending","totalBills","totalRevenue","totalPaid","totalOutstanding","updateDailyData","updatedData","existingIndex","findIndex","push","sort","a","b","getTime","calculateSummary","reduce","delivery","delivered","pending","bills","paymentStatus","total","paid","overdue"],"sources":["/Users/pavan/Desktop/Del update/src/utils/storage.ts"],"sourcesContent":["import { DailyData, Store, Delivery } from '../types';\nimport { format, startOfWeek, endOfWeek, isWithinInterval } from 'date-fns';\n\nconst STORAGE_KEYS = {\n  DAILY_DATA: 'delivery-tracker-daily-data',\n  STORES: 'delivery-tracker-stores',\n  SETTINGS: 'delivery-tracker-settings'\n};\n\nexport class StorageManager {\n  static getDailyData(): DailyData[] {\n    try {\n      const data = localStorage.getItem(STORAGE_KEYS.DAILY_DATA);\n      return data ? JSON.parse(data) : [];\n    } catch (error) {\n      console.error('Error loading daily data:', error);\n      return [];\n    }\n  }\n\n  static saveDailyData(data: DailyData[]): void {\n    try {\n      localStorage.setItem(STORAGE_KEYS.DAILY_DATA, JSON.stringify(data));\n    } catch (error) {\n      console.error('Error saving daily data:', error);\n    }\n  }\n\n  static getStores(): Store[] {\n    try {\n      const data = localStorage.getItem(STORAGE_KEYS.STORES);\n      return data ? JSON.parse(data) : [];\n    } catch (error) {\n      console.error('Error loading stores:', error);\n      return [];\n    }\n  }\n\n  static saveStores(stores: Store[]): void {\n    try {\n      localStorage.setItem(STORAGE_KEYS.STORES, JSON.stringify(stores));\n    } catch (error) {\n      console.error('Error saving stores:', error);\n    }\n  }\n\n  static getTodayData(): DailyData | null {\n    const allData = this.getDailyData();\n    const today = format(new Date(), 'yyyy-MM-dd');\n    return allData.find(data => data.date === today) || null;\n  }\n\n  static getWeekData(): DailyData[] {\n    const allData = this.getDailyData();\n    const now = new Date();\n    const weekStart = startOfWeek(now, { weekStartsOn: 1 });\n    const weekEnd = endOfWeek(now, { weekStartsOn: 1 });\n    \n    return allData.filter(data => {\n      const dataDate = new Date(data.date);\n      return isWithinInterval(dataDate, { start: weekStart, end: weekEnd });\n    });\n  }\n\n  static createEmptyDailyData(date: Date): DailyData {\n    return {\n      date: format(date, 'yyyy-MM-dd'),\n      deliveries: [],\n      summary: {\n        totalStores: 0,\n        totalDeliveries: 0,\n        totalDelivered: 0,\n        totalPending: 0,\n        totalBills: 0,\n        totalRevenue: 0,\n        totalPaid: 0,\n        totalOutstanding: 0\n      }\n    };\n  }\n\n  static updateDailyData(updatedData: DailyData): void {\n    const allData = this.getDailyData();\n    const existingIndex = allData.findIndex(data => data.date === updatedData.date);\n    \n    if (existingIndex >= 0) {\n      allData[existingIndex] = updatedData;\n    } else {\n      allData.push(updatedData);\n    }\n    \n    // Sort by date descending\n    allData.sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\n    \n    this.saveDailyData(allData);\n  }\n\n  static calculateSummary(deliveries: Delivery[]): DailyData['summary'] {\n    return deliveries.reduce((summary, delivery) => ({\n      totalStores: summary.totalStores + 1,\n      totalDeliveries: summary.totalDeliveries + delivery.totalDeliveries,\n      totalDelivered: summary.totalDelivered + delivery.delivered,\n      totalPending: summary.totalPending + delivery.pending,\n      totalBills: summary.totalBills + delivery.bills,\n      totalRevenue: summary.totalRevenue + delivery.paymentStatus.total,\n      totalPaid: summary.totalPaid + delivery.paymentStatus.paid,\n      totalOutstanding: summary.totalOutstanding + delivery.paymentStatus.pending + delivery.paymentStatus.overdue\n    }), {\n      totalStores: 0,\n      totalDeliveries: 0,\n      totalDelivered: 0,\n      totalPending: 0,\n      totalBills: 0,\n      totalRevenue: 0,\n      totalPaid: 0,\n      totalOutstanding: 0\n    });\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}